[
  {
    "path": "portfolio/2022-03-01-clusters/",
    "title": "Linkages Between Stream Chemistries",
    "description": "An agglomerative heirarchical clustering (via complete linkage) of stream chemistries at the Santa Barbara Coastal LTER.",
    "author": [
      {
        "name": "Mari Herbst de Cortina",
        "url": {}
      }
    ],
    "date": "2022-03-01",
    "categories": [],
    "contents": "\n\n\nClick to show code\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\n# attach packages\nlibrary(tidyverse)\nlibrary(here)\nlibrary(ggdendro)\nlibrary(naniar)\nlibrary(janitor)\n\n\n\nIntroduction\nIn this report I will explore multivariate linkages between water\nchemistry of streams in the Santa Barbara Coastal LTER. I will use\ncomplete linkage analysis to identify clusters among the streams based\non the average values of 9 variables: ammonium (uM/L), nitrate (uM/L),\nphosphate (uM/L), total dissolved nitrogen (um/L), total dissolved\nphosphorus (uM/L), total particulate carbon (uM/L), total particulate\nnitrogen (uM/L), total particulate phosphorus (uM/L), total suspended\nsolids (mg/L), and specific conductivity (measured at 25C in sS/cm).\nComplete\nAgglomerative Heirarchical Clustering\n\n\nClick to show code\n\n# read in data using here to create a system agnostic file path\nstream <- read_csv(here(\"data\", \"sbc_lter_registered_stream_chemistry.csv\")) %>%\n  clean_names() %>% # clean up column names\n  replace_with_na_all(condition = ~.x == -999) # change -999 values to NA\n\n\n\n\n\nClick to show code\n\n# create a subset with summarized values per site\nstream_site <- stream %>%\n  group_by(site_code) %>%\n  summarize(mean_nh4_um = mean(nh4_u_m, na.rm = TRUE), # summarize by the mean value across observations at each site\n            mean_no3_um = mean(no3_u_m, na.rm = TRUE),\n            mean_po4_um = mean(po4_u_m, na.rm = TRUE),\n            mean_tdn_um = mean(tdn_u_m, na.rm = TRUE),\n            mean_tdp_um = mean(tdp_u_m, na.rm = TRUE),\n            mean_tpc_um = mean(tpc_u_m, na.rm = TRUE),\n            mean_tpn_um = mean(tpn_u_m, na.rm = TRUE),\n            tss_mgper_liter = mean(tss_mgper_liter, na.rm = TRUE),\n            spec_cond_u_spercm = mean(tss_mgper_liter, na.rm = TRUE)) %>%\n  drop_na() # drop sites that have NA values\n\n\n\n\n\nClick to show code\n\nsite_scaled <- stream_site %>%\n  select(-site_code) %>% # remove site code column because we don't want to include those values in the analysis\n  scale()\n\nrownames(site_scaled) <- stream_site$site_code # add stream site codes back to scaled data as row names\n\n\n\n\n\nClick to show code\n\n# find euclidean distance using scaled data\nsite_dist <- dist(site_scaled,\n                  method = \"euclidean\")\n\n# hierarchical clustering (complete linkage)\nsite_hc_comp <- hclust(site_dist,\n                       method = \"complete\")\n\n\n\nDendrogram\n\n\nClick to show code\n\n# save the hierarchical clustering as a dendrogram\nsite_dend <- as.dendrogram(site_hc_comp)\n\n# visualize\nggdendrogram(site_dend,\n             rotate = TRUE) +\n  theme_minimal() +\n  labs(x = \"site ID\",\n       y = \"distance\",\n       title = \"Complete Linkage Dendrogram for Stream Site Chemistry at SBC LTER\")\n\n\n\n\nFigure 1: Complete linkage analysis of clusters\nbetween chemistry at streams in the Santa Barbara Coastal LTER. Cluster\ndistance indicates the smallest maximum Euclidean distance between\npoints in the cluster.\nConclusions\nAccording to the complete linkage dendrogram:\nStream ON02 is the most unlike the other streams\nMC00 and AB00 are the most similar in their stream chemistry as\ndemonstrated by the short distance between their linkage\nData Citation\nSanta Barbara Coastal LTER and J. Melack. 2019. SBC LTER: Land:\nStream chemistry in the Santa Barbara Coastal drainage area, ongoing\nsince 2000 ver 16. Environmental Data Initiative. https://doi.org/10.6073/pasta/67a558a24ceed9a0a5bf5e46ab841174.\n\n\n\n",
    "preview": "portfolio/2022-03-01-clusters/clusters_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-03-01T20:36:33-08:00",
    "input_file": {}
  },
  {
    "path": "portfolio/2022-03-01-hareweight/",
    "title": "Linear Regression of Hare Weights by Hind Foot Length",
    "description": "An analysis of the viability of hind foot length as a predictor for weight in juvenile hares.",
    "author": [
      {
        "name": "Mari Herbst de Cortina",
        "url": {}
      }
    ],
    "date": "2022-03-01",
    "categories": [],
    "contents": "\nIntroduction\nThis report explores data collected about snowshoe hares across sites\nin the Bonanza Creek LTER between 1998 and 2012 (Kielland et al. (2017).\nThe report investigates whether there is a linear relationship between\njuvenile hare weights and hind foot length.\nSnowshoe hares in the Bonanza Creek LTER in Alaska were trapped and\nmeasured over the course of 14 years (1998-2012). The hares were\nobserved at three locations – the Bonanza Riparian zone, the Bonanza\nBlack Spruce zone, and the Bonanza Mature zone, representing three\ndifferent landscapes in the region. The hares were measured for sex\n(male, female, NA), age (adult, juvenile, NA), weight (g), and hind foot\nlength (mm).\nThis report visualizes the relationship between weight and hind foot\nlength in juvenile hares. A simple linear regression is used to explore\nthe potential relationship between hind foot length and weight. All\nanalyses are in R version 4.1.1 using RStudio version 1.4.1717.\nVisualization and Regression\nModel\n\n\nClick here to show code\n\n# Read in the data using here() to create a system agnostic file path.\nbonanza_hares <- read_csv(here(\"data\", \"bonanza_hares.csv\"))\n\n\n\n\n\nClick here to show code\n\n# Change labels to make data easier to understand once visualized\nbonanza_clean <- bonanza_hares %>%\n  filter(age == \"j\") %>% # filter for juvenile hares\n  mutate(sex = case_when( # when sex =\n         sex == \"m\" ~ \"male\", # \"m\" change to \"male\"\n         sex == \"f\" ~ \"female\",\n         TRUE ~ \"unknown\")) %>%\n  mutate(grid = case_when( # when grid =\n         grid == \"bonbs\" ~ \"Bonanza Black Spruce\", # \"bonbs\" change to \"Bonanza Black Spruce\"\n         grid == \"bonrip\" ~ \"Bonanza Riparian\",\n         grid == \"bonmat\" ~ \"Bonanza Mature\"))\n\n\n\n\n\nClick here to show code\n\n# create a data frame for only juvenile males and females\nhares_j_m_f <- bonanza_clean %>% # start with bonanza_clean\n  filter(sex == \"male\" | sex == \"female\") # filter for observations where sex is male or female\n\n# Create a table of summary statistics for hare weights\nweight_summary_stats <- hares_j_m_f %>%\n  group_by(sex) %>%\n  summarize(mean_weight = round(mean(weight, na.rm = TRUE), 2), # summarize and name columns, 'na.rm = TRUE' to remove NA values, round() to choose number of digits\n            median_weight = median(weight, na.rm = TRUE), \n            sd_weight = round(sd(weight, na.rm = TRUE), 2),\n            sample_size = n())\n\n\n\n\n\nClick here to show code\n\nggplot(data = bonanza_clean, aes(x = hindft, y = weight)) +\n  geom_point(color = \"deeppink3\") +\n  theme_minimal() +\n  theme(text = element_text(family = \"Calibri\", # change the font and bold for easier reading\n                            face = \"bold\"),\n        plot.title = element_text(hjust = 0.5)) +  # center plot title\n  labs(x = \"hind foot length (mm)\", # name axes and title\n       y =\"weight (g)\",\n       title = \"Juvenile Hare Weight by Hind Foot Length\") +\n  geom_smooth(method = \"lm\", color = \"lightslateblue\") # add regression line\n\n\n\n\nFigure 1: Juvenile Hare Weight by Hind Foot Length:\nAn exploration of the trends of 363 snowshoe hares’ weights (g) relative\nto their hind foot lengths (mm). Linear regression line included (\\(\\beta\\)1 = 9.52 \\(\\frac{g}{mm}\\), Pearson’s r: 0.55, R\\(^2\\) = 0.299).\nConclusions\nBased on this model, we would expect an average increase in hare body\nweight of 9.52g per 1mm increase in hind foot length. The model also\nindicates that hind foot length is predictive of 29.88% of variance in\nsnowshoe hare weights. There is moderate positive correlation between\nhare hind foot length and weight (Pearson’s r: 0.55). I have some\nconcerns about making the assumption that this data set can be described\nby a linear regression. The R\\(^2\\)\nvalue and Pearson’s r demonstrate that there is some correlation between\nhind foot length and weight, but not a strong correlation enough\ncorrelation to explain all variance in weights. Further, the data\nappears to demonstrate heteroscedasticity rather than homoscedasticity,\nindicating there is not constant variance in the errors of\nobservations.\nJuvenile hare weight and hind foot length are loosely correlated, but\nthere is not enough correlation to explain the full variance in weights.\nAlso, there are concerns about using a linear regression model for this\ndata because the assumptions for linear regression are not met.\nData citation\nKielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017.\nSnowshoe hare physical data in Bonanza Creek Experimental Forest:\n1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14\n\n\n\n",
    "preview": "portfolio/2022-03-01-hareweight/hareweight_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-03-01T20:23:45-08:00",
    "input_file": {}
  },
  {
    "path": "portfolio/2022-03-01-monolake/",
    "title": "Mono Lake Water Levels",
    "description": "Visualization of Mono Lake water levels with significant historical events.",
    "author": [
      {
        "name": "Mari Herbst de Cortina",
        "url": {}
      }
    ],
    "date": "2022-03-01",
    "categories": [],
    "contents": "\nIntroduction\nThis report explores Mono Lake annual water levels from 1850 to 2017\nin terms of feet above sea level. Since the 1940s, Los Angeles’s\nDepartment of Water & Power has been diverting water away from Mono\nLake in order to meet the city’s water demands. A study in the 1970s\nrevealed that reducing the level and volume of the lake was resulting in\necological damage affecting the native wildlife including California\nGulls, Eared Grebes, Osprey, and Brine Shrimp, among many others. The\nstudents who conducted the study founded the Mono Lake Committee (MLC)\nwith the goal of saving this ecosystem and have been recording and\nreporting on the lake’s conditions ever since.\nVisualization\n\n\nClick to show code\n\nknitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)\n\n# attach packages\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(plotly)\nlibrary(ggrepel)\n\n\n\n\n\nClick to show code\n\n# read in data using here() to create a system agnostic file path\n\nmono_lake <- read_csv(here(\"data\", \"mono_lake_annual_levels.csv\"), skip = 5) %>% # use skip to begin the table at a different row than row 1\n  clean_names() # make column names coder friendly\n\n\n\n\n\nClick to show code\n\nmono_history <- mono_lake %>% # create a dataframe with years of historical events\n  filter(year %in% c(1941, 1976, 1978, 1994, 2013)) %>% # filter for relevant years\n  mutate(significance = c(\"diversion begins\", \"initial ecological study\", \"MLC founded\", \"stability level est.\", \"MBSRA approved\")) # add column to attribute historical significance\n\n\n\n\n\nClick to show code\n\nggplot(data = mono_lake, aes(x = year, y = lake_level_feet_above_sea_level)) + # create a plot using the complete mono_lake data\n  geom_line(color = \"deepskyblue2\", size = 1) + # make it a blue line graph\n  labs(y = \"feet above sea level\", # label axes and title\n       title = \"Mono Lake Annual Levels\",\n       caption = \"data courtesy of Mono Basin Clearinghouse\") +\n  geom_hline(yintercept = 6392, color = \"darkolivegreen4\", alpha = 0.7) + # add horizontal lines for significant lake levels\n  geom_hline(yintercept = 6377, color = \"goldenrod1\", alpha = 0.7) +\n  geom_hline(yintercept = 6360, color = \"coral1\", alpha = 0.7) +\n  geom_point(data = mono_history, # create overlapping plot with mono_history data frame\n             aes (x = year, y = lake_level_feet_above_sea_level), # assign x and y variables\n             color = \"darkorchid1\", size = 1.25) + # add color and change size of points\n  theme(plot.title = element_text(hjust = 0.5)) + # add a plot title and center it\n  annotate(\"text\", # add label for horizontal lines of significant levels\n           y = 6390, # dictate location\n           x = 1862,\n           size = 3, # dictate size\n           label = \"stable lake level\", # label the line\n           color = \"darkolivegreen4\") + # add color\n  annotate(\"text\", # do same as above for each line\n           y = 6375,\n           x = 1865.8,\n           size = 3,\n           label = \"land bridge emerges\",\n           color = \"goldenrod1\") +\n  annotate(\"text\", # do same as above for each line\n           y = 6358,\n           x = 1875,\n           size = 3,\n           label = \"salinity impedes brine shrimp pop\",\n           color = \"coral1\") +\n  geom_label_repel(data = mono_history, # add labels to the years of historical significance\n                   aes(x = year, y = lake_level_feet_above_sea_level, # indicate x and y variables\n                       label = significance), # label the points according to the significance column\n                   box.padding = 1, # box. and point.padding adjust position and size of labels\n                   point.padding = 0.1) +\n  scale_x_continuous(limits = c(1850, 2017), # adjust x axis scale to be from 1850 to 2020\n                     breaks = seq(1850, 2020, 10), # breaks every 10 years\n                     expand = c(0, 0)) + # remove buffer zone\n  scale_y_continuous(limits = c(6350, 6430), # adjust y axis scale to be from 6350 to 6430\n                     breaks = seq(6350, 6430, 20), # breaks every 20 feet\n                     expand = c(0, 0)) # remove buffer zone\n\n\n\n\nFigure 1: Annual levels of Mono Lake from 1850 to\n2017 in terms of feet above sea level. In the 2017 Mono Basin Stream\nRestoration Agreement (MBSRA) was approved, but has not yet implemented\nby DWP. The green line indicates the lake level that the CA State Water\nBoard mandated must be maintained for the lake to be stable (6,392\nfeet). The yellow line indicates the level at which land bridges emerge\nthat allow coyotes to prey on nesting birds (6,377 feet above sea\nlevel). The orange line indicates the level at which salinity is high\nenough to reduce brine shrimp populations that many native birds rely on\n(120 g/L at 6,360 feet above sea level). Point labels indicate\nsignificant historical events affecting Mono Lake.\n\n\n\n",
    "preview": "portfolio/2022-03-01-monolake/monolake_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-03-01T20:21:54-08:00",
    "input_file": {}
  },
  {
    "path": "portfolio/2022-03-01-pcausda/",
    "title": "Dairy Product Nutrient PCA",
    "description": "A principal components analysis to determine if there is a correlation between nutritional indices for dairy products.",
    "author": [
      {
        "name": "Mari Herbst de Cortina",
        "url": {}
      }
    ],
    "date": "2022-03-01",
    "categories": [],
    "contents": "\n\n\nClick to show code\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\n# attach packages\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(ggfortify)\n\n\n\nIntroduction\nIn this report I will explore whether there is correlation between\nnutritional indices for dairy products. The data comes from USDA’s\nNational Nutritional Database. I will use Principle Components Analysis\nto investigate how the energy (kcal), protein (g), fat (g), carbs (g),\nsugar (g), and fiber (g) content of these dairy products relate to each\nother. I will use the PC analysis to create a biplot that demonstrates\nmagnitude and direction of correspondence between nutritional indices as\nwell as a screeplot that shows the amount of variance explained by each\nprinciple component.\nPrincipal Components\nAnalysis\n\n\nClick to show code\n\n# read in data using here to create a system agnostic file path\nusda_nutrients <- read_csv(here(\"data\", \"usda_nutrients.csv\"))\n\n\n\n\n\nClick to show code\n\n# create a function to indicate NOT in\n\"%!in%\" <- Negate(\"%in%\")\n\n\n\n\n\nClick to show code\n\n# wrangle data\nusda_dairy <- usda_nutrients %>%\n  janitor::clean_names() %>% # make column names easier to work with\n  filter(food_group == \"Dairy and Egg Products\") %>% # select only dairy and egg data\n  drop_na(descrip, energy_kcal, protein_g, fat_g, carb_g, sugar_g, fiber_g) %>% # drop NA values in columns that will be analyzed\n  separate(col = descrip, # separate the column descrip\n           into = c(\"category\", \"details\"), # into two columns\n           sep = \",\", # separate at the first comma\n           extra = \"merge\", # if there are multiple, merge them into the second column\n           remove = TRUE) %>% # remove original column \"descrip\"\n  mutate(category = ifelse(str_detect(category, \"KRAFT\"), \"Kraft\", category)) %>% # replace category observations that contain the brand name Kraft with just \"Kraft\"\n  mutate(category = ifelse(str_detect(category, \"Cheese\"), \"Cheese\", category)) %>% # replace observations that contain the word cheese with simply \"Cheese\"\n  mutate(category = ifelse(str_detect(category, \"Cream\"), \"Cream\", category)) %>% # same for cream with \"cream\"\n  mutate(category = ifelse(str_detect(category, \"Queso\"), \"Cheese\", category)) %>% # and queso with \"cheese\"\n  mutate(category = ifelse(str_detect(category, \"Parmesan cheese topping\"), \"Cheese\", category)) %>% # and Parmesan topping with \"cheese\"\n  mutate(category = ifelse(str_detect(category, \"Ice cream\"), \"Ice cream\", category)) %>% # and ice cream with \"ice cream\"\n  filter(category %!in% c(\"Eggs\", \"Egg substitute\", \"Egg\", \"Egg Mix\", \"Protein supplement\", \"Sour dressing\", \"USDA Commodity\", \"Nutritional supplement for people with diabetes\", \"Reddi Wip Fat Free Whipped Topping\")) %>% # remove observations from some categories\n  select(-(id:short_descrip), -(vit_a_mcg:zinc_usrda), -(details:scientific_name)) # remove irrelevant columns\n\n\n\n\n\nClick to show code\n\n# rename column names for graph finalization\ncolnames(usda_dairy) <- c(\"category\", \"energy (kcal)\", \"protein (g)\", \"fat (g)\", \"carbs (g)\", \"sugar (g)\", \"fiber (g)\")\n\n\n\n\n\nClick to show code\n\n# run a PCA on the data\ndairy_pca <- usda_dairy %>%\n  select(-category) %>% # remove columns that won't be included in analysis\n  scale() %>% # scale the data so that values are comparable\n  prcomp()\n\n\n\nBiplot\n\n\nClick to show code\n\nautoplot(dairy_pca,\n         data = usda_dairy,\n         loadings = TRUE, # arrows\n         colour = \"category\",\n         loadings.label = TRUE, # label arrows\n         loadings.colour = \"black\", # change arrow color\n         loadings.label.colour = \"black\", # change arrow label color\n         loadings.label.vjust = -0.5) + # adjust arrow label position\n  labs(title = \"Principle Component Analysis of Health Indices for Dairy Products\") + # add figure title\n  theme_minimal() # add theme\n\n\n\n\nFigure 1: A principle component analysis of\nnutritional indices of dairy products as recorded by the USDA. Arrows\nindicate the magnitude and direction of each factors’ influence on the\nprinciple components. Arrows that are close together indicate a strong\ncorrelation between the indices; right angles between arrows indicate\nthe indices are not correlated.\nScreeplot\n\n\nClick to show code\n\nsd_vec <- dairy_pca$sdev # extract standard deviations into a vector\n\nvar_vec <- sd_vec^2 # calculate variance from SD\n\npc_names <- colnames(dairy_pca$rotation) # quickly get column names from pca object\n\npct_explained_df <- data.frame(v = var_vec, # put vectors into a df as column values\n                               pct_v = var_vec/sum(var_vec), # calculate percentages of variance by PC\n                               pc = fct_inorder(pc_names)) %>% # order the percentages\n  mutate(pct_lbl = paste0(round(pct_v * 100, 1),\"%\")) # paste0 makes it so there are no spaces between the value and the percent sign\n\nggplot(data = pct_explained_df,\n       aes(x = pc, y = v)) +\n  geom_col(fill= \"cornflowerblue\") + # add color\n  geom_text(aes(label = pct_lbl), vjust = 0, nudge_y = 0.005) + # add labels with % variance explained by each one\n  labs(x = \"Principal component\", y = \"Variance explained\",\n       title = \"Screeplot of level of variance explained by each principle component\")\n\n\n\n\nFigure 2: This screeplot shows the variance that is\naccounted for by each principle component from the PCA of the USDA dairy\ndata. The combined variance shown combines to 100%, with each descending\nprinciple components explaining a lower amount of variance than the\nprinciple component before it.\nConclusions\nThe PC1 and PC2 principle components only account for around 70% of\nthe variance in this data, so much of the variance in this nutritional\ndata is still not accounted for. Based on the screeplot, we can see that\nit might be worthwhile to add PC3 into this analysis to explain a larger\npercentage of the variance. However, the information we have from PC1\nand PC2 indicates that:\nCarbs and sugar content are highly positively\ncorrelated.\nCarbs and sugar content are not correlated with fat\ncontent.\nFiber content and energy content are not correlated.\nProtein, fat, and energy content are somewhat positively\ncorrelated.\nData Citation\nU.S. Department of Agriculture, Agricultural Research Service.\nFoodData Central, 2019. fdc.nal.usda.gov.\n\n\n\n",
    "preview": "portfolio/2022-03-01-pcausda/pcausda_files/figure-html5/unnamed-chunk-6-1.png",
    "last_modified": "2022-03-01T20:37:06-08:00",
    "input_file": {}
  }
]
